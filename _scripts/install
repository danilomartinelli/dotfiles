#!/usr/bin/env bash
#
# Run all dotfiles installers.

set -e

cd "$(dirname "$0")"/.. || exit 1

echo "> set taps"
brew tap xo/xo

echo "› brew bundle"
brew bundle

# find the installers and run them iteratively (ignoring folders starting with _)
# find the installers and run them iteratively with error handling
find . -name install.sh -not -path './_*' | while read -r installer; do
    echo "› Running installer: $installer"
    if ! sh -c "${installer}"; then
        echo "ERROR: Failed to run installer: $installer" >&2
        exit 1
    fi
done
